<div class="pdf-image-viewer-container">
  <h1>PDF & Image Merger / Viewer</h1>

  <div class="file-input-section">
    <input
      type="file"
      multiple
      accept=".pdf, .png, .jpg, .jpeg"
      title="Selecione PDF ou imagens"
      placeholder="Escolha arquivos"
      (change)="onFileSelected($event)"
    />
    <button (click)="mergeAndDownload()" [disabled]="pdfManager.managedFiles().length === 0">
      Merge & Download PDF
    </button>
  </div>

  <div class="content-section">
    <div class="file-list-panel">
      <h2>Selected Files</h2>
      @if (pdfManager.managedFiles().length === 0) {
      <p>No files selected.</p>
      } @else {
      <div class="file-list">
        @for (managedFile of pdfManager.managedFiles(); track managedFile.id) {
        <div (click)="selectFileForPreview(managedFile)" class="file-item">
          <span class="file-name">{{ managedFile.file.name }}</span>
          <div class="file-status">
            @if (managedFile.state === 'compressing') {
            <div class="progress-bar">
              <div class="progress" [style.width.%]="managedFile.progress"></div>
            </div>
            <span class="status-text">Compressing...</span>
            } @else if (managedFile.state === 'compressed') {
            <span class="status-text-compressed">✓ Compressed</span>
            } @else if (managedFile.state === 'error') {
            <span class="status-text-error">✗ Error</span>
            }
          </div>
          <button (click)="$event.stopPropagation(); removeFile(managedFile.id)" class="remove-btn">
            X
          </button>
        </div>
        }
      </div>
      }
    </div>
  </div>
</div>

<app-preview-modal></app-preview-modal>
